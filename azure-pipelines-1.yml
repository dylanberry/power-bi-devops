parameters:
  - name: PbixFileUrl
    type: string
    displayName: Pbix File Url

trigger: none

pool: default

steps:
- checkout: none

- powershell: Invoke-WebRequest -Uri '${{ parameters.PbixFileUrl }}' -OutFile '$(Build.BinariesDirectory)/sample.pbix'

- powershell: |
    $env:PBITOOLS_LogLevel = 'Verbose'
    C:\pbi-tools\pbi-tools.exe extract '$(Build.BinariesDirectory)\sample.pbix'
  displayName: 'Extract PBIX'

- publish: '$(Build.BinariesDirectory)\sample'
  artifact: 'sample.pbix'